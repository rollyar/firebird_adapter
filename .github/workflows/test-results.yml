name: Test Results

on:
  workflow_run:
    workflows: ["Full Test Suite - Firebird Adapter"]
    types:
      - completed

jobs:
  test-report:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion != 'skipped' }}
    
    steps:
    - name: Report Status
      run: |
        echo "ğŸ§ª Test Workflow Status: ${{ github.event.workflow_run.conclusion }}"
        echo "ğŸ“Š Workflow: ${{ github.event.workflow_run.name }}"
        echo "ğŸ”— Repository: ${{ github.repository }}"
        echo "ğŸ·ï¸ Branch: ${{ github.event.workflow_run.head_branch }}"
        echo "ğŸ“ Commit: ${{ github.event.workflow_run.head_sha }}"
        
        if [ "${{ github.event.workflow_run.conclusion }}" = "success" ]; then
          echo "âœ… All tests passed!"
          exit 0
        else
          echo "âŒ Some tests failed or workflow had issues"
          echo "ğŸ”— Check the workflow run: ${{ github.event.workflow_run.html_url }}"
          exit 1
        fi

  coverage-report:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    
    steps:
    - uses: actions/checkout@v4
    
    - name: Generate Coverage Report
      run: |
        echo "ğŸ“ˆ Coverage analysis for successful test run"
        echo "ğŸ“Š Test suite completed successfully"
        echo "ğŸ¯ All quality checks passed"